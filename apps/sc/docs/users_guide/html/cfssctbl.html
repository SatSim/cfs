<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CFS Stored Command Application on : CFS Stored Command Table Definitions</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="index.html">CFS Stored Command (SC) User's Guide</a></div>
<h1><a class="anchor" name="cfssctbl">CFS Stored Command Table Definitions</a></h1><table border="1" cellpadding="2" width="60%" align="CENTER" cellspacing="3">
<tr>
<td width="20%" align="CENTER"><b><a class="el" href="cfssccmds.html">CFS Stored Command Commands</a></b> </td><td width="20%" align="CENTER"><b><a class="el" href="cfssctlm.html">CFS Stored Command Telemetry</a></b>  </td><td width="20%" align="CENTER"><b><a class="el" href="cfssccfg.html">CFS Stored Command Configuration Parameters</a></b> </td></tr>
</table>
<p>
The CFS Stored Command application utilizes several tables of varying types.<p>
<h2>Load/Dump Tables</h2>
<p>
There are two types of load/dump tables: an ATS table and an RTS table. While there are multiple tables of each type, each table itself is unique. There are two ATS tables (for ATS A and B) and there are multiple (<a class="el" href="sc__platform__cfg_8h.html#d698f831ae59d3e135dfeefcbe977b10">SC_NUMBER_OF_RTS</a>) RTS tables. There is also a single ATS Append table that has the same structure as the ATS tables. The ATS and RTS table structures are different than most other kinds of table structures. Instead of an array of 'C' structures, the ATS and RTS tables are defined by a series of words (<a class="elRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#2e00abb078d312d1d8c4fbcd6be343d8">uint16</a>), with the unused portion at the end (if any) zero filled.<p>
<b>ATS Tables</b><p>
The ATS tables are double-buffer tables. The size of these tables are defined by the configuration parameters <a class="el" href="sc__platform__cfg_8h.html#5a6823770db1b0799a5835f459799ad5">SC_ATS_BUFF_SIZE</a> times <a class="el" href="sc__app_8h.html#b1242d15c712c4d5cf7749d5ba2b1d53">SC_BYTES_IN_WORD</a>. Each table contains a series of ATS commands defined by <a class="el" href="struct_s_c___ats_entry_header__t.html">SC_AtsEntryHeader_t</a>. The structure of a single command is: <ol>
<li>
<b>Command number:</b> This number must be unique for each command in the ATS, and this number must start at 1 (one), and go up to <a class="el" href="sc__platform__cfg_8h.html#f08662efd00a262389f7b19ce4e9af12">SC_MAX_ATS_CMDS</a>. The command numbers must not be zero, must not repeat, and must not go above <a class="el" href="sc__platform__cfg_8h.html#f08662efd00a262389f7b19ce4e9af12">SC_MAX_ATS_CMDS</a> -1. </li>
<li>
<b>Time Tag:</b> A 32-bit <a class="el" href="sc__tbldefs_8h.html#28d20ba745b8e9e01873312162938000">SC_AbsTimeTag_t</a> type that specifies the absolute time at which this ATS command should execute and is specified as a number of seconds, as received from the <a class="elRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__time_8h.html#bf540f01ef8e0b2c7f2ec755148b6ac6">CFE_TIME_GetTime</a> functions. This time can either be UTC, TAI, or the default cFE Time, as defined by the <a class="el" href="sc__platform__cfg_8h.html#2837e8a58fa404358d6b0d6b433d36c2">SC_TIME_TO_USE</a> platform configuration parameter. </li>
<li>
<b>Command:</b> The variable-length command to send out on the Software Bus. This command must have a valid checksum in the checksum field or it will not be sent out.<br>
 <b>NOTE:</b> If the command length (in bytes) is odd, the user must add a pad byte to the ATS command structure so that the next command starts on a word (<a class="elRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#2e00abb078d312d1d8c4fbcd6be343d8">uint16</a>) boundary. </li>
</ol>
<p>
Despite the many error checks built in to the ATP to assure that it does not cause any ill effects on the spacecraft, there is a crucial safety measure that is required of all ATS tables. The ATP relies on a sentinel word of zeroes at the end of an ATS table to signal the end of the ATS table (end of data marker). cFE Table Services, when loading a new table, unconditionally fills the table working buffer with the contents of the current table prior to placing the new table file contents into the buffer. If a newly loaded ATS table does not contain the sentinel word of zeroes at the end of the table and is smaller than the table that was previously loaded, the newly loaded table has potential to execute the "old" invalid commands that were part of the prior table load. It is therefore essential for operators to place the sentinel word of zeroes at the end of each ATS table including ATS append tables.<p>
<b>RTS Tables</b><p>
The RTS tables are single-buffer tables. The size of these tables are defined by the configuration parameters <a class="el" href="sc__platform__cfg_8h.html#f34c920689afd5bacf09815aae605339">SC_RTS_BUFF_SIZE</a> times <a class="el" href="sc__app_8h.html#b1242d15c712c4d5cf7749d5ba2b1d53">SC_BYTES_IN_WORD</a>. Each table contains a series of RTS commands defined by <a class="el" href="struct_s_c___rts_entry_header__t.html">SC_RtsEntryHeader_t</a>. The structure of a single command is: <ol>
<li>
<b>Time Tag:</b> A 32-bit <a class="el" href="sc__tbldefs_8h.html#07ebc63653b9d76d3d37ad1faef78297">SC_RelTimeTag_t</a> type that specifies the relative time at which this RTS command should execute from which the last RTS command in this RTS was executed and is specified as the number of seconds from the current time. If the Time Tag is zero, then there will be no delay in sending out this command. If it is non zero, the delay will be the number of seconds from the time the last RTS command in this RTS was sent out. The first RTS command can have a delay value. It will be interpreted as a delay from the time the RTS was started. </li>
<li>
<b>Command:</b> The variable-length command to send out on the Software Bus. This command must have a valid checksum in the checksum field or it will not be sent out.<br>
 <b>NOTE:</b> If the command length (in bytes) is odd, the user must add a pad byte to the RTS command structure so that the next command starts on a word (<a class="elRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#2e00abb078d312d1d8c4fbcd6be343d8">uint16</a>) boundary. </li>
</ol>
<p>
<b>ATS Append Table</b><p>
The ATS Append table is a double-buffer table. The size of this table is defined by the configuration parameters <a class="el" href="sc__platform__cfg_8h.html#d13d7fe4d1d7befb877253962c1a792e">SC_APPEND_BUFF_SIZE</a> times <a class="el" href="sc__app_8h.html#b1242d15c712c4d5cf7749d5ba2b1d53">SC_BYTES_IN_WORD</a>. The table contains a series of ATS commands defined by <a class="el" href="struct_s_c___ats_entry_header__t.html">SC_AtsEntryHeader_t</a>. The structure of a single command is the same as the ATS table command structure defined above.<p>
<h2>Dump-Only Tables</h2>
<p>
SC uses the following dump-only tables for status information which can be useful in debugging situations. These tables are defined as single buffer tables with the structures defined below.<p>
<b>Absolute Time Processor (ATP) Control Block Table</b><p>
The ATP Control Block table is defined by <a class="el" href="struct_s_c___atp_control_block__t.html">SC_AtpControlBlock_t</a>. This table contains data items to keep track of the execution of an ATS on the ATP. The fields include: <ol>
<li>
<b>AtpState:</b> This field has the current state of the Absolute Time Processor. It can be IDLE or EXECUTING. </li>
<li>
<b>AtsNumber:</b> This field has the number of the current or last executed ATS. The possible values are: 0 for none (after power on or cold restart), 1 for ATS A, and 2 for ATS B. </li>
<li>
<b>CmdNumber:</b> This field has the current or last executed ATS command number. </li>
<li>
<b>TimeIndexPtr:</b> This field has the table offset into the ATS Time Index Table of the next ATS command to execute. </li>
<li>
<b>SwitchPendFlag:</b> This flag indicates that an ATS switch is pending. This flag is used for internal logic. </li>
</ol>
<p>
<b>ATS Information Table</b><p>
The ATS Information table is defined by <a class="el" href="struct_s_c___ats_info_table__t.html">SC_AtsInfoTable_t</a>. The SC application defines one of these tables for each ATS table created. This table contains data items that provide information about the ATS. The fields include: <ol>
<li>
<b>Usage Counter:</b> A counter that increments each time the ATS is used </li>
<li>
<b>Command Count:</b> The number of commands contained in the ATS </li>
<li>
<b>Size:</b> The size of the ATS. </li>
</ol>
<p>
<b>ATS Append Information Table</b><p>
The ATS Append Info table is defined by <a class="el" href="struct_s_c___ats_info_table__t.html">SC_AtsInfoTable_t</a> just like the ATS Info tables described above. There is only one ATS Append Info Table defined and it provides information about the ATS Append table described earlier.<p>
<b>RTS Information Table</b><p>
The RTS Information Table is used to keep the current status of each RTS table. This table contains one record for each RTS table as defined by <a class="el" href="struct_s_c___rts_info_entry__t.html">SC_RtsInfoEntry_t</a>. The fields of each entry include: <ol>
<li>
<b>Status flag:</b> The status of the associated RTS. This can be EMPTY, LOADED, or EXECUTING. </li>
<li>
<b>Disabled flag:</b> Indicates whether the associated RTS is Enabled or Disabled. If Disabled, the RTS cannot be started. </li>
<li>
<b>Command Counter:</b> The number of commands executed in this execution of the RTS. </li>
<li>
<b>Command Error Counter:</b> The number of errors that have occurred during this RTS execution. Currently, an RTS will stop when it encounters an error, so the counter should never increment past 1. </li>
<li>
<b>Next Command Time:</b> The computed absolute time the next command will execute. </li>
<li>
<b>Next Command Pointer:</b> An offset (in 16-bit words) into the RTS Table of the next command. </li>
<li>
<b>Usage Counter:</b> The number of times that the associated RTS has been started since the last time it was loaded. </li>
</ol>
<p>
<b>RTP Control Block Table</b><p>
The RTP Control Block table is defined by <a class="el" href="struct_s_c___rtp_control_block__t.html">SC_RtpControlBlock_t</a>. This table contains data items to keep track of the RTS's executing on the RTP. The fields include: <ol>
<li>
<b>Active RTS's:</b> The number of RTS's currently active (started). </li>
<li>
<b>RtsNumber:</b> The current RTS number that is executing on the RTP. Note that this field is only cleared out when another RTS is started, allowing the ground to note the last RTS that ran on the RTP. </li>
</ol>
<p>
Next: <a class="el" href="cfssccfg.html">CFS Stored Command Configuration Parameters</a> <br>
 Prev: <a class="el" href="cfssctlm.html">CFS Stored Command Telemetry</a> <hr size="1"><address style="align: right;"><small>Generated on Fri Dec 19 17:03:08 2014 for CFS Stored Command Application on  by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
