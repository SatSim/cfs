<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CFS Health and Safety (HS) Application on  User&apos;s Guide: hs/fsw/src/hs_custom.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_25ec4ca9088ca3393fef37a219ea5b99.html">hs</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a003aab9c2aec371e2e6ad72464013bc.html">fsw</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_f94b2989503c017403f25123b4cc1757.html">src</a></div>
<h1>hs_custom.c</h1><a href="hs__custom_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">** File:</span>
<a name="l00003"></a>00003 <span class="comment">**   $Id: hs__custom_8c-source.html 1.1 2015/03/03 13:10:26EST sstrege Exp  $</span>
<a name="l00004"></a>00004 <span class="comment">**</span>
<a name="l00005"></a>00005 <span class="comment">**   Copyright © 2007-2014 United States Government as represented by the </span>
<a name="l00006"></a>00006 <span class="comment">**   Administrator of the National Aeronautics and Space Administration. </span>
<a name="l00007"></a>00007 <span class="comment">**   All Other Rights Reserved.  </span>
<a name="l00008"></a>00008 <span class="comment">**</span>
<a name="l00009"></a>00009 <span class="comment">**   This software was created at NASA's Goddard Space Flight Center.</span>
<a name="l00010"></a>00010 <span class="comment">**   This software is governed by the NASA Open Source Agreement and may be </span>
<a name="l00011"></a>00011 <span class="comment">**   used, distributed and modified only pursuant to the terms of that </span>
<a name="l00012"></a>00012 <span class="comment">**   agreement.</span>
<a name="l00013"></a>00013 <span class="comment">**</span>
<a name="l00014"></a>00014 <span class="comment">**   Purpose: Health and Safety (HS) application custom component.</span>
<a name="l00015"></a>00015 <span class="comment">**   This custom code is designed to work without modification; however the</span>
<a name="l00016"></a>00016 <span class="comment">**   nature of specific platforms may make it desirable to modify this code</span>
<a name="l00017"></a>00017 <span class="comment">**   to work in a more efficient way, or to provide greater functionality.</span>
<a name="l00018"></a>00018 <span class="comment">**</span>
<a name="l00019"></a>00019 <span class="comment">**   $Log: hs__custom_8c-source.html  $</span>
<a name="l00019"></a>00019 <span class="comment">**   Revision 1.1 2015/03/03 13:10:26EST sstrege </span>
<a name="l00019"></a>00019 <span class="comment">**   Initial revision</span>
<a name="l00019"></a>00019 <span class="comment">**   Member added to project c:/MKSDATA/MKS-REPOSITORY/CFS-REPOSITORY/hs/docs/users_guide/html/project.pj</span>
<a name="l00020"></a>00020 <span class="comment">**   Revision 1.3 2015/03/03 12:16:07EST sstrege </span>
<a name="l00021"></a>00021 <span class="comment">**   Added copyright information</span>
<a name="l00022"></a>00022 <span class="comment">**   Revision 1.2 2011/10/17 16:45:21EDT aschoeni </span>
<a name="l00023"></a>00023 <span class="comment">**   paramters are now signed integers</span>
<a name="l00024"></a>00024 <span class="comment">**   Revision 1.1 2011/10/13 18:48:59EDT aschoeni </span>
<a name="l00025"></a>00025 <span class="comment">**   Initial revision</span>
<a name="l00026"></a>00026 <span class="comment">**   Member added to project c:/MKSDATA/MKS-REPOSITORY/CFS-REPOSITORY/hs/fsw/src/project.pj</span>
<a name="l00027"></a>00027 <span class="comment">**   Revision 1.6 2011/08/08 14:56:08EDT aschoeni </span>
<a name="l00028"></a>00028 <span class="comment">**   Moved idle task execution counter increment outside of nominal loop</span>
<a name="l00029"></a>00029 <span class="comment">**   Revision 1.5 2010/11/17 17:05:08EST aschoeni </span>
<a name="l00030"></a>00030 <span class="comment">**   minor fixes for CPU utilization</span>
<a name="l00031"></a>00031 <span class="comment">**   Revision 1.4 2010/10/14 17:45:57EDT aschoeni </span>
<a name="l00032"></a>00032 <span class="comment">**   Removed assumptions of rate of utilization measurement</span>
<a name="l00033"></a>00033 <span class="comment">**   Revision 1.3 2010/10/14 15:32:40EDT aschoeni </span>
<a name="l00034"></a>00034 <span class="comment">**   Add skipping of 'first' match for calibration to avoid 0xFFFFFFFF match</span>
<a name="l00035"></a>00035 <span class="comment">**   Revision 1.2 2010/09/29 18:28:23EDT aschoeni </span>
<a name="l00036"></a>00036 <span class="comment">**   Added Utilization Monitoring</span>
<a name="l00037"></a>00037 <span class="comment">**   Revision 1.1 2010/09/13 16:34:37EDT aschoeni </span>
<a name="l00038"></a>00038 <span class="comment">**   Initial revision</span>
<a name="l00039"></a>00039 <span class="comment">**   Member added to project c:/MKSDATA/MKS-REPOSITORY/CFS-REPOSITORY/hs/fsw/src/project.pj</span>
<a name="l00040"></a>00040 <span class="comment">**   Revision 1.1 2010/07/19 11:49:54EDT aschoeni </span>
<a name="l00041"></a>00041 <span class="comment">**   Initial revision</span>
<a name="l00042"></a>00042 <span class="comment">**   Member added to project c:/MKSDATA/MKS-REPOSITORY/MMS-REPOSITORY/dev/eeprom-fsw/apps/hs/fsw/src/project.pj</span>
<a name="l00043"></a>00043 <span class="comment">**</span>
<a name="l00044"></a>00044 <span class="comment">*************************************************************************/</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">/*************************************************************************</span>
<a name="l00047"></a>00047 <span class="comment">** Includes</span>
<a name="l00048"></a>00048 <span class="comment">*************************************************************************/</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include "<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe_8h.html">cfe.h</a>"</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include "<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__psp_8h.html">cfe_psp.h</a>"</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include "<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/osapi_8h.html">osapi.h</a>"</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include "hs_app.h"</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include "hs_cmds.h"</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include "<a class="code" href="hs__msg_8h.html">hs_msg.h</a>"</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include "hs_custom.h"</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include "<a class="code" href="hs__events_8h.html">hs_events.h</a>"</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include "hs_monitors.h"</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include "<a class="code" href="hs__perfids_8h.html">hs_perfids.h</a>"</span>
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="hs__custom_8c.html#cbdd505ea5dbd21599afa5bad49e28c3">00060</a> <span class="preprocessor">#define HS_UTIL_DIAG_REPORTS 4</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a>00062 <span class="comment">/*</span>
<a name="l00063"></a>00063 <span class="comment">** Command Codes</span>
<a name="l00064"></a>00064 <span class="comment">** Custom codes must not conflict with those in hs_msgdefs.h</span>
<a name="l00065"></a>00065 <span class="comment">*/</span>
<a name="l00066"></a>00066 
<a name="l00094"></a><a class="code" href="hs__custom_8c.html#9c6415759103589fe2fc235646ffa89c">00094</a> <span class="preprocessor">#define HS_REPORT_DIAG_CC          12</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00122"></a><a class="code" href="hs__custom_8c.html#611a5265341379a96015e40ecf20a2de">00122</a> <span class="preprocessor">#define HS_SET_UTIL_PARAMS_CC      13</span>
<a name="l00123"></a>00123 <span class="preprocessor"></span>
<a name="l00149"></a><a class="code" href="hs__custom_8c.html#56d5586d01e78bc6a2912bb58da1baae">00149</a> <span class="preprocessor">#define HS_SET_UTIL_DIAG_CC        14</span>
<a name="l00150"></a>00150 <span class="preprocessor"></span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="comment">/*</span>
<a name="l00153"></a>00153 <span class="comment">** Event IDs</span>
<a name="l00154"></a>00154 <span class="comment">** Custom Event IDs must not conflict with those in hs_events.h</span>
<a name="l00155"></a>00155 <span class="comment">*/</span>
<a name="l00156"></a>00156 
<a name="l00171"></a><a class="code" href="hs__custom_8c.html#79931c59441eb6f8b715570ad6f51c90">00171</a> <span class="preprocessor">#define HS_CR_CHILD_TASK_ERR_EID 101</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>
<a name="l00187"></a><a class="code" href="hs__custom_8c.html#e203788c8df7be039a5a11384888fe4c">00187</a> <span class="preprocessor">#define HS_CR_SYNC_CALLBACK_ERR_EID 102</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>
<a name="l00201"></a><a class="code" href="hs__custom_8c.html#e11944dbbcf6ccaa6b06d25268ba30fa">00201</a> <span class="preprocessor">#define HS_UTIL_DIAG_REPORT_EID 103</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span>
<a name="l00214"></a><a class="code" href="hs__custom_8c.html#e737aeaf5b619803e967f821954e9123">00214</a> <span class="preprocessor">#define HS_SET_UTIL_PARAMS_DBG_EID 104</span>
<a name="l00215"></a>00215 <span class="preprocessor"></span>
<a name="l00228"></a><a class="code" href="hs__custom_8c.html#eb1a2ba812c9908f7fce9c2665c1a2b8">00228</a> <span class="preprocessor">#define HS_SET_UTIL_PARAMS_ERR_EID 105</span>
<a name="l00229"></a>00229 <span class="preprocessor"></span>
<a name="l00241"></a><a class="code" href="hs__custom_8c.html#2215015078a70d9b8e05545fc983059f">00241</a> <span class="preprocessor">#define HS_SET_UTIL_DIAG_DBG_EID 106</span>
<a name="l00242"></a>00242 <span class="preprocessor"></span>
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="comment">/*</span>
<a name="l00245"></a>00245 <span class="comment">** Command Structure Definitions</span>
<a name="l00246"></a>00246 <span class="comment">*/</span>
<a name="l00247"></a><a class="code" href="struct_h_s___set_util_params_cmd__t.html">00247</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00248"></a>00248 <span class="keyword"></span>{
<a name="l00249"></a><a class="code" href="struct_h_s___set_util_params_cmd__t.html#4e4669212967f3819fac00535ed34f3e">00249</a>     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>          CmdHeader[<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__sb_8h.html#cc49ae58990b23f72824e1b742c78cb8">CFE_SB_CMD_HDR_SIZE</a>];
<a name="l00250"></a><a class="code" href="struct_h_s___set_util_params_cmd__t.html#6b35ad3372ed3e79eea5b5184cfc7bfb">00250</a>     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a>          Mult1;
<a name="l00251"></a><a class="code" href="struct_h_s___set_util_params_cmd__t.html#908d07fa25b4851576b588c710b645b3">00251</a>     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a>          Div;
<a name="l00252"></a><a class="code" href="struct_h_s___set_util_params_cmd__t.html#d747dd76c36a085a694391e4f289c522">00252</a>     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a>          Mult2;
<a name="l00253"></a>00253 } <a class="code" href="struct_h_s___set_util_params_cmd__t.html">HS_SetUtilParamsCmd_t</a>;
<a name="l00254"></a>00254 
<a name="l00255"></a><a class="code" href="struct_h_s___set_util_diag_cmd__t.html">00255</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00256"></a>00256 <span class="keyword"></span>{
<a name="l00257"></a><a class="code" href="struct_h_s___set_util_diag_cmd__t.html#3b6e2193a9166e04a2a20b69882e7c6e">00257</a>     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>          CmdHeader[<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__sb_8h.html#cc49ae58990b23f72824e1b742c78cb8">CFE_SB_CMD_HDR_SIZE</a>];
<a name="l00258"></a><a class="code" href="struct_h_s___set_util_diag_cmd__t.html#b57d6618ab9c8eccad0ad42a718f8711">00258</a>     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>         Mask;
<a name="l00259"></a>00259 } <a class="code" href="struct_h_s___set_util_diag_cmd__t.html">HS_SetUtilDiagCmd_t</a>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="comment">/*</span>
<a name="l00263"></a>00263 <span class="comment">** Custom Global Data Structure</span>
<a name="l00264"></a>00264 <span class="comment">*/</span>
<a name="l00265"></a><a class="code" href="struct_h_s___custom_data__t.html">00265</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00266"></a>00266 <span class="keyword"></span>{
<a name="l00267"></a><a class="code" href="struct_h_s___custom_data__t.html#6268e049cce566fc13f3e7ae74db2a34">00267</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a>    UtilMult1;
<a name="l00268"></a><a class="code" href="struct_h_s___custom_data__t.html#1b31888ee1f3e2fad28375732a908a87">00268</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a>    UtilDiv;
<a name="l00269"></a><a class="code" href="struct_h_s___custom_data__t.html#fcb6b03332023c991463276be4937682">00269</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a>    UtilMult2;
<a name="l00271"></a><a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">00271</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   UtilMask;
<a name="l00272"></a><a class="code" href="struct_h_s___custom_data__t.html#72c9155bf1eef7aebb64fc23fc045ae3">00272</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   UtilArrayIndex;
<a name="l00273"></a><a class="code" href="struct_h_s___custom_data__t.html#dbcf8d12a6cbb9d693f5b826f4190106">00273</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   UtilArrayMask;
<a name="l00274"></a><a class="code" href="struct_h_s___custom_data__t.html#93ce0b26ef4af74b5593d604bc2810cf">00274</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   UtilArray[<a class="code" href="hs__platform__cfg_8h.html#18a612393a047f79010d214d13cd1f72">HS_UTIL_TIME_DIAG_ARRAY_LENGTH</a>];
<a name="l00276"></a><a class="code" href="struct_h_s___custom_data__t.html#a0f58e22fe55067ce144e7e7c7f9fd59">00276</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   ThisIdleTaskExec;
<a name="l00277"></a><a class="code" href="struct_h_s___custom_data__t.html#b1956fee18faa9f38f79e0c0c64cb089">00277</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   LastIdleTaskExec;
<a name="l00278"></a><a class="code" href="struct_h_s___custom_data__t.html#65ec9daad716fa3b79e1014242cc6992">00278</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   LastIdleTaskInterval;
<a name="l00279"></a><a class="code" href="struct_h_s___custom_data__t.html#69911bb1e73366abc40187bb2458a4bb">00279</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   UtilCycleCounter;
<a name="l00282"></a><a class="code" href="struct_h_s___custom_data__t.html#de32513bad3051917bc8e16862a1b8fd">00282</a>    <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a>   IdleTaskRunStatus;
<a name="l00283"></a><a class="code" href="struct_h_s___custom_data__t.html#c09adc81777c16706dd655ff786fc9cf">00283</a>   <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>   IdleTaskID;
<a name="l00285"></a>00285 } <a class="code" href="struct_h_s___custom_data__t.html">HS_CustomData_t</a>;
<a name="l00286"></a>00286 
<a name="l00287"></a><a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">00287</a> <a class="code" href="struct_h_s___custom_data__t.html">HS_CustomData_t</a> <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 <span class="comment">/************************************************************************</span>
<a name="l00290"></a>00290 <span class="comment">** Local function prototypes</span>
<a name="l00291"></a>00291 <span class="comment">*************************************************************************/</span>
<a name="l00292"></a>00292 <span class="comment">/************************************************************************/</span>
<a name="l00305"></a>00305 <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#724cdab2a39dd9087eed5e2a9f15d433">HS_IdleTask</a>(<span class="keywordtype">void</span>);
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="comment">/************************************************************************/</span>
<a name="l00321"></a>00321 <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#fce2d4dcb366f0a506c5c4eec5da9868">HS_UtilizationIncrement</a>(<span class="keywordtype">void</span>);
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="comment">/************************************************************************/</span>
<a name="l00337"></a>00337 <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#079917adb6dcc95dd601758b04dfe8c1">HS_UtilizationMark</a>(<span class="keywordtype">void</span>);
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 <span class="comment">/************************************************************************/</span>
<a name="l00349"></a>00349 <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#411ba093991286e3e87a92920ea6834f">HS_MarkIdleCallback</a>(<span class="keywordtype">void</span>);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="comment">/************************************************************************/</span>
<a name="l00361"></a>00361 <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#91b9a44c588f28d76d13e13a218192d5">HS_UtilDiagReport</a>(<span class="keywordtype">void</span>);
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 <span class="comment">/************************************************************************/</span>
<a name="l00373"></a>00373 <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#e7c50494d4effbe0f7564deba71e17e6">HS_SetUtilParamsCmd</a>(<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/struct_c_f_e___s_b___msg__t.html">CFE_SB_MsgPtr_t</a> MessagePtr);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375 <span class="comment">/************************************************************************/</span>
<a name="l00385"></a>00385 <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#661cb490649afe4ef821742f807f0e82">HS_SetUtilDiagCmd</a>(<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/struct_c_f_e___s_b___msg__t.html">CFE_SB_MsgPtr_t</a> MessagePtr);
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00389"></a>00389 <span class="comment">/*                                                                 */</span>
<a name="l00390"></a>00390 <span class="comment">/* Idle Task Main Process Loop                                     */</span>
<a name="l00391"></a>00391 <span class="comment">/*                                                                 */</span>
<a name="l00392"></a>00392 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00393"></a>00393 
<a name="l00394"></a><a class="code" href="hs__custom_8c.html#724cdab2a39dd9087eed5e2a9f15d433">00394</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#724cdab2a39dd9087eed5e2a9f15d433">HS_IdleTask</a>(<span class="keywordtype">void</span>)
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/struct_o_s__time__t.html">OS_time_t</a> PSPTime = {0,0};
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#de32513bad3051917bc8e16862a1b8fd">IdleTaskRunStatus</a> = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__es_8h.html#1e008c905bb89083293355b71ce4bc2d">CFE_ES_RegisterChildTask</a>();
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     <span class="keywordflow">while</span> (<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#de32513bad3051917bc8e16862a1b8fd">IdleTaskRunStatus</a> == <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>)
<a name="l00401"></a>00401     {
<a name="l00402"></a>00402 
<a name="l00403"></a>00403         <span class="comment">/* Check to see if we are to mark the time. */</span>
<a name="l00404"></a>00404         <span class="keywordflow">if</span>(((<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#a0f58e22fe55067ce144e7e7c7f9fd59">ThisIdleTaskExec</a> &amp; <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a>) == <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a>) &amp;&amp;
<a name="l00405"></a>00405            (<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#a0f58e22fe55067ce144e7e7c7f9fd59">ThisIdleTaskExec</a> &gt; <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a>))
<a name="l00406"></a>00406         {
<a name="l00407"></a>00407             <span class="comment">/* Entry and Exit markers are for easy time marking only; not performance */</span>
<a name="l00408"></a>00408             <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__es_8h.html#9ef217a6193ed3db2235b850d5219625">CFE_ES_PerfLogEntry</a>(<a class="code" href="hs__perfids_8h.html#f4ca8882e1f627b4b456726546aa35b5">HS_IDLETASK_PERF_ID</a>);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410             <span class="comment">/* Increment the child task Execution Counter */</span>
<a name="l00411"></a>00411             <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__es_8h.html#2ae693e0bf2c4c430f3a852223cce6d6">CFE_ES_IncrementTaskCounter</a>();
<a name="l00412"></a>00412 
<a name="l00413"></a>00413             <span class="comment">/* update stamp and array */</span>
<a name="l00414"></a>00414             <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__psp_8h.html#dd2a8221c2845259665176cbafc8be23">CFE_PSP_GetTime</a>(&amp;PSPTime);
<a name="l00415"></a>00415             <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#93ce0b26ef4af74b5593d604bc2810cf">UtilArray</a>[<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#72c9155bf1eef7aebb64fc23fc045ae3">UtilArrayIndex</a> &amp; <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#dbcf8d12a6cbb9d693f5b826f4190106">UtilArrayMask</a>] = (<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a>) PSPTime.<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/struct_o_s__time__t.html#cad716a15e85ab4da15d801d9b9831dd">microsecs</a>;
<a name="l00416"></a>00416             <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#72c9155bf1eef7aebb64fc23fc045ae3">UtilArrayIndex</a>++;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418             <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__es_8h.html#19d8dd9bb016a1bec9fdae7cfeb3fbd4">CFE_ES_PerfLogExit</a>(<a class="code" href="hs__perfids_8h.html#f4ca8882e1f627b4b456726546aa35b5">HS_IDLETASK_PERF_ID</a>);
<a name="l00419"></a>00419         }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="comment">/* Call the Utilization Tracking function */</span>
<a name="l00422"></a>00422         <a class="code" href="hs__custom_8c.html#fce2d4dcb366f0a506c5c4eec5da9868">HS_UtilizationIncrement</a>();
<a name="l00423"></a>00423 
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425 
<a name="l00426"></a>00426     <span class="comment">/*</span>
<a name="l00427"></a>00427 <span class="comment">    ** If the run status is externally set to something else</span>
<a name="l00428"></a>00428 <span class="comment">    */</span>
<a name="l00429"></a>00429     <span class="keywordflow">return</span>;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 } <span class="comment">/* End of HS_IdleTask() */</span>
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00434"></a>00434 <span class="comment">/*                                                                 */</span>
<a name="l00435"></a>00435 <span class="comment">/* Initialize The Idle Task                                        */</span>
<a name="l00436"></a>00436 <span class="comment">/*                                                                 */</span>
<a name="l00437"></a>00437 <span class="comment">/* NOTE: For complete prolog information, see 'hs_custom.h'        */</span>
<a name="l00438"></a>00438 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00439"></a><a class="code" href="hs__custom_8c.html#c376ee15b6d4d2dba69e54cb0b62a8b4">00439</a> <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a> <a class="code" href="hs__custom_8c.html#c376ee15b6d4d2dba69e54cb0b62a8b4">HS_CustomInit</a>(<span class="keywordtype">void</span>)
<a name="l00440"></a>00440 {
<a name="l00441"></a>00441     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a> Status = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     <span class="comment">/*</span>
<a name="l00444"></a>00444 <span class="comment">    ** Spawn the Idle Task</span>
<a name="l00445"></a>00445 <span class="comment">    */</span>
<a name="l00446"></a>00446     Status = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__es_8h.html#be9c2d4ac57b8d3cc9e5e929b7150038">CFE_ES_CreateChildTask</a>(&amp;<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#c09adc81777c16706dd655ff786fc9cf">IdleTaskID</a>,      
<a name="l00447"></a>00447                                      <a class="code" href="hs__platform__cfg_8h.html#35dd6b87cfce1139eb65356a8abcf2fb">HS_IDLE_TASK_NAME</a>,       
<a name="l00448"></a>00448                                      <a class="code" href="hs__custom_8c.html#724cdab2a39dd9087eed5e2a9f15d433">HS_IdleTask</a>,         
<a name="l00449"></a>00449                                      <a class="code" href="hs__platform__cfg_8h.html#c1d9084f09a74e0608813ff0758093a8">HS_IDLE_TASK_STACK_PTR</a>,  
<a name="l00450"></a>00450                                      <a class="code" href="hs__platform__cfg_8h.html#9ddb20db59176efa4c73439cca93ffcc">HS_IDLE_TASK_STACK_SIZE</a>, 
<a name="l00451"></a>00451                                      <a class="code" href="hs__platform__cfg_8h.html#8c4c98db2162226dfa7cf56472c64cf1">HS_IDLE_TASK_PRIORITY</a>,   
<a name="l00452"></a>00452                                      <a class="code" href="hs__platform__cfg_8h.html#ff271ce7e34ff7b92fe1135ae7eaeb04">HS_IDLE_TASK_FLAGS</a>);     
<a name="l00453"></a>00453      
<a name="l00454"></a>00454     <span class="keywordflow">if</span>(Status != <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>)
<a name="l00455"></a>00455     {
<a name="l00456"></a>00456         <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#ab8630735c7be46fb4162323a112d298">CFE_EVS_SendEvent</a>(<a class="code" href="hs__custom_8c.html#79931c59441eb6f8b715570ad6f51c90">HS_CR_CHILD_TASK_ERR_EID</a>, <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#d98a59324d59e7f8a2f6162887197832">CFE_EVS_ERROR</a>,
<a name="l00457"></a>00457                           <span class="stringliteral">"Error Creating Child Task for CPU Utilization Monitoring,RC=0x%08X"</span>,
<a name="l00458"></a>00458                           Status);
<a name="l00459"></a>00459         <span class="keywordflow">return</span> (Status);
<a name="l00460"></a>00460     }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     <span class="comment">/*</span>
<a name="l00463"></a>00463 <span class="comment">    ** Connect to CFE TIME's time reference marker (typically 1 Hz) for Idle Task Marking</span>
<a name="l00464"></a>00464 <span class="comment">    */</span>
<a name="l00465"></a>00465     Status = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__time_8h.html#e13a973062a2174417e4a30465a12146">CFE_TIME_RegisterSynchCallback</a>((<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__time_8h.html#6a86c92284606f1e6965742724fb75c7">CFE_TIME_SynchCallbackPtr_t</a>)&amp;<a class="code" href="hs__custom_8c.html#411ba093991286e3e87a92920ea6834f">HS_MarkIdleCallback</a>);
<a name="l00466"></a>00466     <span class="keywordflow">if</span> (Status != <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>)
<a name="l00467"></a>00467     {
<a name="l00468"></a>00468         <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#ab8630735c7be46fb4162323a112d298">CFE_EVS_SendEvent</a>(<a class="code" href="hs__custom_8c.html#e203788c8df7be039a5a11384888fe4c">HS_CR_SYNC_CALLBACK_ERR_EID</a>, <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#d98a59324d59e7f8a2f6162887197832">CFE_EVS_ERROR</a>,
<a name="l00469"></a>00469                           <span class="stringliteral">"Error Registering Sync Callback for CPU Utilization Monitoring,RC=0x%08X"</span>,
<a name="l00470"></a>00470                           Status);
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#6268e049cce566fc13f3e7ae74db2a34">UtilMult1</a> = <a class="code" href="hs__platform__cfg_8h.html#4f1378f01b9c0acd0b71a53346318a30">HS_UTIL_CONV_MULT1</a>;
<a name="l00474"></a>00474     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#fcb6b03332023c991463276be4937682">UtilMult2</a> = <a class="code" href="hs__platform__cfg_8h.html#c3f3abff71ebf0f11df537c214167d00">HS_UTIL_CONV_DIV</a>;
<a name="l00475"></a>00475     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1b31888ee1f3e2fad28375732a908a87">UtilDiv</a>   = <a class="code" href="hs__platform__cfg_8h.html#f4f042b9199589bcf8801f503da3609f">HS_UTIL_CONV_MULT2</a>;
<a name="l00476"></a>00476     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a>  = <a class="code" href="hs__platform__cfg_8h.html#6e058e49652df03567c72bad2e7e318a">HS_UTIL_DIAG_MASK</a>;
<a name="l00477"></a>00477     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#69911bb1e73366abc40187bb2458a4bb">UtilCycleCounter</a> = 0;
<a name="l00478"></a>00478     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a> = <a class="code" href="hs__platform__cfg_8h.html#6e058e49652df03567c72bad2e7e318a">HS_UTIL_DIAG_MASK</a>;
<a name="l00479"></a>00479     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#72c9155bf1eef7aebb64fc23fc045ae3">UtilArrayIndex</a> = 0;
<a name="l00480"></a>00480     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#dbcf8d12a6cbb9d693f5b826f4190106">UtilArrayMask</a> = <a class="code" href="hs__platform__cfg_8h.html#fd699792417a20e0ebe7524936967f23">HS_UTIL_TIME_DIAG_ARRAY_MASK</a>;
<a name="l00481"></a>00481     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#a0f58e22fe55067ce144e7e7c7f9fd59">ThisIdleTaskExec</a> = 0;
<a name="l00482"></a>00482     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#b1956fee18faa9f38f79e0c0c64cb089">LastIdleTaskExec</a> = 0;
<a name="l00483"></a>00483     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#65ec9daad716fa3b79e1014242cc6992">LastIdleTaskInterval</a> = 0;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485     <span class="keywordflow">return</span>(Status);
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 } <span class="comment">/* end HS_CustomInit */</span>
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00490"></a>00490 <span class="comment">/*                                                                 */</span>
<a name="l00491"></a>00491 <span class="comment">/* Terminate The Idle Task                                         */</span>
<a name="l00492"></a>00492 <span class="comment">/*                                                                 */</span>
<a name="l00493"></a>00493 <span class="comment">/* NOTE: For complete prolog information, see 'hs_custom.h'        */</span>
<a name="l00494"></a>00494 <span class="comment">/*                                                                 */</span>
<a name="l00495"></a>00495 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00496"></a><a class="code" href="hs__custom_8c.html#6d8edf353c5ff8d7d9dc55101fa0a050">00496</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#6d8edf353c5ff8d7d9dc55101fa0a050">HS_CustomCleanup</a>(<span class="keywordtype">void</span>)
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a> Status = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>;
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     <span class="comment">/*</span>
<a name="l00501"></a>00501 <span class="comment">    ** Unregister the Sync Callback for CPU Monitoring</span>
<a name="l00502"></a>00502 <span class="comment">    */</span>
<a name="l00503"></a>00503     Status = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__time_8h.html#d858c0f4363c7e3e44692dd522483026">CFE_TIME_UnregisterSynchCallback</a>((<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__time_8h.html#6a86c92284606f1e6965742724fb75c7">CFE_TIME_SynchCallbackPtr_t</a>)&amp;<a class="code" href="hs__custom_8c.html#411ba093991286e3e87a92920ea6834f">HS_MarkIdleCallback</a>);
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="comment">/*</span>
<a name="l00506"></a>00506 <span class="comment">    ** Force the Idle Task to stop running</span>
<a name="l00507"></a>00507 <span class="comment">    */</span>
<a name="l00508"></a>00508     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#de32513bad3051917bc8e16862a1b8fd">IdleTaskRunStatus</a> = !<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="comment">/*</span>
<a name="l00511"></a>00511 <span class="comment">    ** Delete the Idle Task</span>
<a name="l00512"></a>00512 <span class="comment">    */</span>
<a name="l00513"></a>00513     Status = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__es_8h.html#f17fa3dd427191492771b1ca929f45a2">CFE_ES_DeleteChildTask</a>(<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#c09adc81777c16706dd655ff786fc9cf">IdleTaskID</a>);
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 } <span class="comment">/* end HS_CustomCleanup */</span>
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00518"></a>00518 <span class="comment">/*                                                                 */</span>
<a name="l00519"></a>00519 <span class="comment">/* Increment the Utilization Counter                               */</span>
<a name="l00520"></a>00520 <span class="comment">/*                                                                 */</span>
<a name="l00521"></a>00521 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00522"></a><a class="code" href="hs__custom_8c.html#fce2d4dcb366f0a506c5c4eec5da9868">00522</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#fce2d4dcb366f0a506c5c4eec5da9868">HS_UtilizationIncrement</a>(<span class="keywordtype">void</span>)
<a name="l00523"></a>00523 {
<a name="l00524"></a>00524     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#a0f58e22fe55067ce144e7e7c7f9fd59">ThisIdleTaskExec</a>++;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="keywordflow">return</span>;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528 } <span class="comment">/* end HS_UtilizationIncrement */</span>
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00531"></a>00531 <span class="comment">/*                                                                 */</span>
<a name="l00532"></a>00532 <span class="comment">/* Mark the Utilization Counter                                    */</span>
<a name="l00533"></a>00533 <span class="comment">/*                                                                 */</span>
<a name="l00534"></a>00534 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00535"></a><a class="code" href="hs__custom_8c.html#079917adb6dcc95dd601758b04dfe8c1">00535</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#079917adb6dcc95dd601758b04dfe8c1">HS_UtilizationMark</a>(<span class="keywordtype">void</span>)
<a name="l00536"></a>00536 {
<a name="l00537"></a>00537     <span class="keyword">static</span> <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> CycleCount = 0;
<a name="l00538"></a>00538 
<a name="l00539"></a>00539     CycleCount++;
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     <span class="keywordflow">if</span>(CycleCount &gt;= <a class="code" href="hs__platform__cfg_8h.html#bbf2b3f9c5a917b908ceaee3fe108968">HS_UTIL_CALLS_PER_MARK</a>)
<a name="l00542"></a>00542     {
<a name="l00543"></a>00543        <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#65ec9daad716fa3b79e1014242cc6992">LastIdleTaskInterval</a> = <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#a0f58e22fe55067ce144e7e7c7f9fd59">ThisIdleTaskExec</a> - <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#b1956fee18faa9f38f79e0c0c64cb089">LastIdleTaskExec</a>;
<a name="l00544"></a>00544        <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#b1956fee18faa9f38f79e0c0c64cb089">LastIdleTaskExec</a> = <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#a0f58e22fe55067ce144e7e7c7f9fd59">ThisIdleTaskExec</a>;
<a name="l00545"></a>00545        CycleCount = 0;
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="keywordflow">return</span>;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 } <span class="comment">/* end HS_UtilizationMark */</span>
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00553"></a>00553 <span class="comment">/*                                                                 */</span>
<a name="l00554"></a>00554 <span class="comment">/* Callback function that marks the Idle time                      */</span>
<a name="l00555"></a>00555 <span class="comment">/*                                                                 */</span>
<a name="l00556"></a>00556 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00557"></a><a class="code" href="hs__custom_8c.html#411ba093991286e3e87a92920ea6834f">00557</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#411ba093991286e3e87a92920ea6834f">HS_MarkIdleCallback</a>(<span class="keywordtype">void</span>)
<a name="l00558"></a>00558 {
<a name="l00559"></a>00559     <span class="comment">/*</span>
<a name="l00560"></a>00560 <span class="comment">    ** Capture the CPU Utilization (at a consistant time)</span>
<a name="l00561"></a>00561 <span class="comment">    */</span>
<a name="l00562"></a>00562     <a class="code" href="hs__custom_8c.html#079917adb6dcc95dd601758b04dfe8c1">HS_UtilizationMark</a>();
<a name="l00563"></a>00563 
<a name="l00564"></a>00564     <span class="keywordflow">return</span>;
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 } <span class="comment">/* End of HS_MarkIdleCallback() */</span>
<a name="l00567"></a>00567 
<a name="l00568"></a>00568 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00569"></a>00569 <span class="comment">/*                                                                 */</span>
<a name="l00570"></a>00570 <span class="comment">/* Performs Utilization Monitoring and reporting                   */</span>
<a name="l00571"></a>00571 <span class="comment">/*                                                                 */</span>
<a name="l00572"></a>00572 <span class="comment">/* NOTE: For complete prolog information, see 'hs_custom.h'        */</span>
<a name="l00573"></a>00573 <span class="comment">/*                                                                 */</span>
<a name="l00574"></a>00574 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00575"></a><a class="code" href="hs__custom_8c.html#031f684d419609073afbaebd1f1de416">00575</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#031f684d419609073afbaebd1f1de416">HS_CustomMonitorUtilization</a>(<span class="keywordtype">void</span>)
<a name="l00576"></a>00576 {
<a name="l00577"></a>00577     <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#69911bb1e73366abc40187bb2458a4bb">UtilCycleCounter</a>++;
<a name="l00578"></a>00578     <span class="keywordflow">if</span> (<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#69911bb1e73366abc40187bb2458a4bb">UtilCycleCounter</a> &gt;= <a class="code" href="hs__platform__cfg_8h.html#9f23ea35d95aa6fb4cdb71c07b52eafd">HS_UTIL_CYCLES_PER_INTERVAL</a>)
<a name="l00579"></a>00579     {
<a name="l00580"></a>00580         HS_MonitorUtilization();
<a name="l00581"></a>00581         <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#69911bb1e73366abc40187bb2458a4bb">UtilCycleCounter</a> = 0;
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584 } <span class="comment">/* End of HS_CustomMonitorUtilization() */</span>
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00587"></a>00587 <span class="comment">/*                                                                 */</span>
<a name="l00588"></a>00588 <span class="comment">/* Processes any additional commands                               */</span>
<a name="l00589"></a>00589 <span class="comment">/*                                                                 */</span>
<a name="l00590"></a>00590 <span class="comment">/* NOTE: For complete prolog information, see 'hs_custom.h'        */</span>
<a name="l00591"></a>00591 <span class="comment">/*                                                                 */</span>
<a name="l00592"></a>00592 <span class="comment">/* This function MUST return CFE_SUCCESS if any command is found   */</span>
<a name="l00593"></a>00593 <span class="comment">/* and must NOT return CFE_SUCCESS if no command was found         */</span>
<a name="l00594"></a>00594 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00595"></a><a class="code" href="hs__custom_8c.html#af79d7975ddc806b2efe2a8e2e96bc56">00595</a> <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a> <a class="code" href="hs__custom_8c.html#af79d7975ddc806b2efe2a8e2e96bc56">HS_CustomCommands</a>(<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/struct_c_f_e___s_b___msg__t.html">CFE_SB_MsgPtr_t</a> MessagePtr)
<a name="l00596"></a>00596 {
<a name="l00597"></a>00597     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a> Status = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#2e00abb078d312d1d8c4fbcd6be343d8">uint16</a>          CommandCode = 0;
<a name="l00600"></a>00600 
<a name="l00601"></a>00601     CommandCode = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__sb_8h.html#7b1204be89237bd230fc79ecc88718b5">CFE_SB_GetCmdCode</a>(MessagePtr);
<a name="l00602"></a>00602     <span class="keywordflow">switch</span> (CommandCode)
<a name="l00603"></a>00603     {
<a name="l00604"></a>00604         <span class="keywordflow">case</span> <a class="code" href="hs__custom_8c.html#9c6415759103589fe2fc235646ffa89c">HS_REPORT_DIAG_CC</a>:
<a name="l00605"></a>00605             <a class="code" href="hs__custom_8c.html#91b9a44c588f28d76d13e13a218192d5">HS_UtilDiagReport</a>();
<a name="l00606"></a>00606             <span class="keywordflow">break</span>;
<a name="l00607"></a>00607 
<a name="l00608"></a>00608         <span class="keywordflow">case</span> <a class="code" href="hs__custom_8c.html#611a5265341379a96015e40ecf20a2de">HS_SET_UTIL_PARAMS_CC</a>:
<a name="l00609"></a>00609             <a class="code" href="hs__custom_8c.html#e7c50494d4effbe0f7564deba71e17e6">HS_SetUtilParamsCmd</a>(MessagePtr);
<a name="l00610"></a>00610             <span class="keywordflow">break</span>;
<a name="l00611"></a>00611 
<a name="l00612"></a>00612         <span class="keywordflow">case</span> <a class="code" href="hs__custom_8c.html#56d5586d01e78bc6a2912bb58da1baae">HS_SET_UTIL_DIAG_CC</a>:
<a name="l00613"></a>00613             <a class="code" href="hs__custom_8c.html#661cb490649afe4ef821742f807f0e82">HS_SetUtilDiagCmd</a>(MessagePtr);
<a name="l00614"></a>00614             <span class="keywordflow">break</span>;
<a name="l00615"></a>00615 
<a name="l00616"></a>00616         <span class="keywordflow">default</span>:
<a name="l00617"></a>00617             Status = !<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__error_8h.html#b2b6b188c32c70b8ca0578b7a7bc091b">CFE_SUCCESS</a>;
<a name="l00618"></a>00618             <span class="keywordflow">break</span>;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620     } <span class="comment">/* end CommandCode switch */</span>
<a name="l00621"></a>00621 
<a name="l00622"></a>00622     <span class="keywordflow">return</span> Status;
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 } <span class="comment">/* End of HS_CustomCommands() */</span>
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00627"></a>00627 <span class="comment">/*                                                                 */</span>
<a name="l00628"></a>00628 <span class="comment">/* Report Utilization Diagnostics Information                      */</span>
<a name="l00629"></a>00629 <span class="comment">/*                                                                 */</span>
<a name="l00630"></a>00630 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00631"></a><a class="code" href="hs__custom_8c.html#91b9a44c588f28d76d13e13a218192d5">00631</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#91b9a44c588f28d76d13e13a218192d5">HS_UtilDiagReport</a>(<span class="keywordtype">void</span>)
<a name="l00632"></a>00632 {
<a name="l00633"></a>00633     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> DiagValue[<a class="code" href="hs__platform__cfg_8h.html#18a612393a047f79010d214d13cd1f72">HS_UTIL_TIME_DIAG_ARRAY_LENGTH</a>];
<a name="l00634"></a>00634     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> DiagCount[<a class="code" href="hs__platform__cfg_8h.html#18a612393a047f79010d214d13cd1f72">HS_UTIL_TIME_DIAG_ARRAY_LENGTH</a>];
<a name="l00635"></a>00635     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> i = 0;
<a name="l00636"></a>00636     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> j = 0;
<a name="l00637"></a>00637     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> ThisValue = 0;
<a name="l00638"></a>00638     <span class="keywordtype">boolean</span> MatchFound = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00639"></a>00639     
<a name="l00640"></a>00640     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> Ordinal = 0;
<a name="l00641"></a>00641     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> NewOrdinalIndex = 0;
<a name="l00642"></a>00642     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> OutputValue[<a class="code" href="hs__custom_8c.html#cbdd505ea5dbd21599afa5bad49e28c3">HS_UTIL_DIAG_REPORTS</a>];
<a name="l00643"></a>00643     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> OutputCount[<a class="code" href="hs__custom_8c.html#cbdd505ea5dbd21599afa5bad49e28c3">HS_UTIL_DIAG_REPORTS</a>];
<a name="l00644"></a>00644     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#9560e25c315bae45d1ed4e2ce49ce55a">uint32</a> OutputOrdinal[<a class="code" href="hs__custom_8c.html#cbdd505ea5dbd21599afa5bad49e28c3">HS_UTIL_DIAG_REPORTS</a>];
<a name="l00645"></a>00645 
<a name="l00646"></a>00646     <span class="comment">/* Initialize the arrays */</span>
<a name="l00647"></a>00647     <span class="keywordflow">for</span>(i=0; i &lt; <a class="code" href="hs__platform__cfg_8h.html#18a612393a047f79010d214d13cd1f72">HS_UTIL_TIME_DIAG_ARRAY_LENGTH</a>; i++)
<a name="l00648"></a>00648     {
<a name="l00649"></a>00649         DiagValue[i] = 0xFFFFFFFF;
<a name="l00650"></a>00650         DiagCount[i] = 0;
<a name="l00651"></a>00651     }
<a name="l00652"></a>00652     <span class="keywordflow">for</span>(i=0; i &lt; <a class="code" href="hs__custom_8c.html#cbdd505ea5dbd21599afa5bad49e28c3">HS_UTIL_DIAG_REPORTS</a>; i++)
<a name="l00653"></a>00653     {
<a name="l00654"></a>00654         OutputValue[i] = 0xFFFFFFFF;
<a name="l00655"></a>00655         OutputCount[i] = 0;
<a name="l00656"></a>00656         OutputOrdinal[i] = i;
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659     <span class="comment">/* Populate the arrays */</span>
<a name="l00660"></a>00660     <span class="keywordflow">for</span>(i = 0; i &lt; HS_UTIL_TIME_DIAG_ARRAY_LENGTH; i++)
<a name="l00661"></a>00661     {
<a name="l00662"></a>00662         <span class="keywordflow">if</span>(i == 0)
<a name="l00663"></a>00663         {
<a name="l00664"></a>00664             ThisValue = <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#93ce0b26ef4af74b5593d604bc2810cf">UtilArray</a>[i] - <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#93ce0b26ef4af74b5593d604bc2810cf">UtilArray</a>[HS_UTIL_TIME_DIAG_ARRAY_LENGTH - 1];
<a name="l00665"></a>00665         }
<a name="l00666"></a>00666         <span class="keywordflow">else</span>
<a name="l00667"></a>00667         {
<a name="l00668"></a>00668             ThisValue = <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#93ce0b26ef4af74b5593d604bc2810cf">UtilArray</a>[i] - <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#93ce0b26ef4af74b5593d604bc2810cf">UtilArray</a>[i - 1];
<a name="l00669"></a>00669         }
<a name="l00670"></a>00670         
<a name="l00671"></a>00671         j = 0;
<a name="l00672"></a>00672         MatchFound = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00673"></a>00673         <span class="keywordflow">while</span>((MatchFound == <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>) &amp;&amp; (j &lt; HS_UTIL_TIME_DIAG_ARRAY_LENGTH))
<a name="l00674"></a>00674         {
<a name="l00675"></a>00675             <span class="keywordflow">if</span>(ThisValue == DiagValue[j])
<a name="l00676"></a>00676             {
<a name="l00677"></a>00677                 DiagCount[j]++;
<a name="l00678"></a>00678                 MatchFound = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00679"></a>00679             }
<a name="l00680"></a>00680             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DiagValue[j] == 0xFFFFFFFF)
<a name="l00681"></a>00681             {
<a name="l00682"></a>00682                 DiagValue[j] = ThisValue;
<a name="l00683"></a>00683                 DiagCount[j]++;
<a name="l00684"></a>00684                 MatchFound = <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00685"></a>00685             }
<a name="l00686"></a>00686             <span class="keywordflow">else</span>
<a name="l00687"></a>00687             {
<a name="l00688"></a>00688                 j++;
<a name="l00689"></a>00689             }
<a name="l00690"></a>00690         }
<a name="l00691"></a>00691 
<a name="l00692"></a>00692     }
<a name="l00693"></a>00693 
<a name="l00694"></a>00694     <span class="comment">/* Calculate the lowest time jumps */</span>
<a name="l00695"></a>00695     i = 0;
<a name="l00696"></a>00696     <span class="keywordflow">while</span>((DiagValue[i] != 0xFFFFFFFF) &amp;&amp; (i &lt; HS_UTIL_TIME_DIAG_ARRAY_LENGTH))
<a name="l00697"></a>00697     {
<a name="l00698"></a>00698         Ordinal = 0;
<a name="l00699"></a>00699         <span class="keywordflow">for</span>(j = 0; j &lt; HS_UTIL_DIAG_REPORTS; j++)
<a name="l00700"></a>00700         {
<a name="l00701"></a>00701             <span class="keywordflow">if</span> (OutputValue[j] &lt; DiagValue[i])
<a name="l00702"></a>00702             {
<a name="l00703"></a>00703                 Ordinal++;
<a name="l00704"></a>00704             }
<a name="l00705"></a>00705         }
<a name="l00706"></a>00706         <span class="keywordflow">if</span>(Ordinal &lt; HS_UTIL_DIAG_REPORTS)
<a name="l00707"></a>00707         {
<a name="l00708"></a>00708             <span class="comment">/* Take over the outputs occupied by the current last */</span>
<a name="l00709"></a>00709             NewOrdinalIndex = OutputOrdinal[HS_UTIL_DIAG_REPORTS - 1];
<a name="l00710"></a>00710             OutputValue[NewOrdinalIndex] = DiagValue[i];
<a name="l00711"></a>00711             OutputCount[NewOrdinalIndex] = DiagCount[i];
<a name="l00712"></a>00712             
<a name="l00713"></a>00713             <span class="comment">/* Slide everything else down */</span>
<a name="l00714"></a>00714             <span class="keywordflow">for</span>(j = HS_UTIL_DIAG_REPORTS - 1; j &gt; Ordinal; j--)
<a name="l00715"></a>00715             {
<a name="l00716"></a>00716                  OutputOrdinal[j] = OutputOrdinal[j - 1];
<a name="l00717"></a>00717             }
<a name="l00718"></a>00718 
<a name="l00719"></a>00719             <span class="comment">/* Point to the new output */</span>
<a name="l00720"></a>00720             OutputOrdinal[Ordinal] = NewOrdinalIndex;
<a name="l00721"></a>00721 
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723 
<a name="l00724"></a>00724         i++;
<a name="l00725"></a>00725     }
<a name="l00726"></a>00726     
<a name="l00727"></a>00727     <span class="comment">/* Output the HS_UTIL_DIAG_REPORTS as en event */</span>
<a name="l00728"></a>00728     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#ab8630735c7be46fb4162323a112d298">CFE_EVS_SendEvent</a>(<a class="code" href="hs__custom_8c.html#e11944dbbcf6ccaa6b06d25268ba30fa">HS_UTIL_DIAG_REPORT_EID</a>, <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#9bc5a36744c852941ce1aa5e07932ff4">CFE_EVS_INFORMATION</a>,
<a name="l00729"></a>00729                       <span class="stringliteral">"Mask 0x%08X Base Time Ticks per Idle Ticks (frequency): %i(%i), %i(%i), %i(%i), %i(%i)"</span>, <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a>,
<a name="l00730"></a>00730                        OutputValue[OutputOrdinal[0]], OutputCount[OutputOrdinal[0]], OutputValue[OutputOrdinal[1]], OutputCount[OutputOrdinal[1]], 
<a name="l00731"></a>00731                        OutputValue[OutputOrdinal[2]], OutputCount[OutputOrdinal[2]], OutputValue[OutputOrdinal[3]], OutputCount[OutputOrdinal[3]]);
<a name="l00732"></a>00732 
<a name="l00733"></a>00733     <span class="keywordflow">return</span>;
<a name="l00734"></a>00734 
<a name="l00735"></a>00735 } <span class="comment">/* end HS_UtilDiagReport */</span>
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00739"></a>00739 <span class="comment">/*                                                                 */</span>
<a name="l00740"></a>00740 <span class="comment">/* Report Utilization                                              */</span>
<a name="l00741"></a>00741 <span class="comment">/*                                                                 */</span>
<a name="l00742"></a>00742 <span class="comment">/* NOTE: For complete prolog information, see 'hs_custom.h'        */</span>
<a name="l00743"></a>00743 <span class="comment">/*                                                                 */</span>
<a name="l00744"></a>00744 <span class="comment">/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */</span>
<a name="l00745"></a><a class="code" href="hs__custom_8c.html#44496200bcecd1aeb4a1adb7e7fbdd16">00745</a> <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a> <a class="code" href="hs__custom_8c.html#44496200bcecd1aeb4a1adb7e7fbdd16">HS_CustomGetUtil</a>(<span class="keywordtype">void</span>)
<a name="l00746"></a>00746 {
<a name="l00747"></a>00747    <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#5eb512da689eec1a7472ab97e2ab6be3">int32</a> CurrentUtil = 0;
<a name="l00748"></a>00748 
<a name="l00749"></a>00749    CurrentUtil = <a class="code" href="hs__platform__cfg_8h.html#bc722785a578aea1b2fb25b389d80fd9">HS_UTIL_PER_INTERVAL_TOTAL</a> - (((<a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#65ec9daad716fa3b79e1014242cc6992">LastIdleTaskInterval</a> * <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#6268e049cce566fc13f3e7ae74db2a34">UtilMult1</a>) 
<a name="l00750"></a>00750                                                / <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1b31888ee1f3e2fad28375732a908a87">UtilDiv</a>) 
<a name="l00751"></a>00751                                               * <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#fcb6b03332023c991463276be4937682">UtilMult2</a>);   
<a name="l00752"></a>00752 
<a name="l00753"></a>00753    <span class="keywordflow">return</span> CurrentUtil;
<a name="l00754"></a>00754 }
<a name="l00755"></a>00755 
<a name="l00756"></a><a class="code" href="hs__custom_8c.html#e7c50494d4effbe0f7564deba71e17e6">00756</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#e7c50494d4effbe0f7564deba71e17e6">HS_SetUtilParamsCmd</a>(<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/struct_c_f_e___s_b___msg__t.html">CFE_SB_MsgPtr_t</a> MessagePtr)
<a name="l00757"></a>00757 {
<a name="l00758"></a>00758     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#2e00abb078d312d1d8c4fbcd6be343d8">uint16</a>            ExpectedLength = <span class="keyword">sizeof</span>(<a class="code" href="struct_h_s___set_util_params_cmd__t.html">HS_SetUtilParamsCmd_t</a>);
<a name="l00759"></a>00759     <a class="code" href="struct_h_s___set_util_params_cmd__t.html">HS_SetUtilParamsCmd_t</a>  *CmdPtr;
<a name="l00760"></a>00760 
<a name="l00761"></a>00761     <span class="comment">/*</span>
<a name="l00762"></a>00762 <span class="comment">    ** Verify message packet length</span>
<a name="l00763"></a>00763 <span class="comment">    */</span>
<a name="l00764"></a>00764     <span class="keywordflow">if</span>(HS_VerifyMsgLength(MessagePtr, ExpectedLength))
<a name="l00765"></a>00765     {
<a name="l00766"></a>00766         CmdPtr = ((<a class="code" href="struct_h_s___set_util_params_cmd__t.html">HS_SetUtilParamsCmd_t</a> *)MessagePtr);
<a name="l00767"></a>00767 
<a name="l00768"></a>00768         <span class="keywordflow">if</span>((CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#6b35ad3372ed3e79eea5b5184cfc7bfb">Mult1</a> != 0) &amp;&amp;
<a name="l00769"></a>00769            (CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#d747dd76c36a085a694391e4f289c522">Mult2</a> != 0) &amp;&amp;
<a name="l00770"></a>00770            (CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#908d07fa25b4851576b588c710b645b3">Div</a> != 0))
<a name="l00771"></a>00771         {
<a name="l00772"></a>00772             <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#6268e049cce566fc13f3e7ae74db2a34">UtilMult1</a> = CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#6b35ad3372ed3e79eea5b5184cfc7bfb">Mult1</a>;
<a name="l00773"></a>00773             <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#fcb6b03332023c991463276be4937682">UtilMult2</a> = CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#d747dd76c36a085a694391e4f289c522">Mult2</a>;
<a name="l00774"></a>00774             <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1b31888ee1f3e2fad28375732a908a87">UtilDiv</a>   = CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#908d07fa25b4851576b588c710b645b3">Div</a>;
<a name="l00775"></a>00775             HS_AppData.CmdCount++;
<a name="l00776"></a>00776             <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#ab8630735c7be46fb4162323a112d298">CFE_EVS_SendEvent</a> (<a class="code" href="hs__custom_8c.html#e737aeaf5b619803e967f821954e9123">HS_SET_UTIL_PARAMS_DBG_EID</a>, <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#5551720d052dd752fcf22af0dcdc9d4e">CFE_EVS_DEBUG</a>,
<a name="l00777"></a>00777                                <span class="stringliteral">"Utilization Parms set: Mult1: %d Div: %d Mult2: %d"</span>, 
<a name="l00778"></a>00778                                <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#6268e049cce566fc13f3e7ae74db2a34">UtilMult1</a>, <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1b31888ee1f3e2fad28375732a908a87">UtilDiv</a>, <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#fcb6b03332023c991463276be4937682">UtilMult2</a>);
<a name="l00779"></a>00779         }
<a name="l00780"></a>00780         <span class="keywordflow">else</span>
<a name="l00781"></a>00781         {
<a name="l00782"></a>00782             HS_AppData.CmdErrCount++;
<a name="l00783"></a>00783             <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#ab8630735c7be46fb4162323a112d298">CFE_EVS_SendEvent</a> (<a class="code" href="hs__custom_8c.html#eb1a2ba812c9908f7fce9c2665c1a2b8">HS_SET_UTIL_PARAMS_ERR_EID</a>, <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#d98a59324d59e7f8a2f6162887197832">CFE_EVS_ERROR</a>,
<a name="l00784"></a>00784                                <span class="stringliteral">"Utilization Parms Error: No parameter may be 0: Mult1: %d Div: %d Mult2: %d"</span>, 
<a name="l00785"></a>00785                                CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#6b35ad3372ed3e79eea5b5184cfc7bfb">Mult1</a>, CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#908d07fa25b4851576b588c710b645b3">Div</a>, CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_params_cmd__t.html#d747dd76c36a085a694391e4f289c522">Mult2</a>);
<a name="l00786"></a>00786         }
<a name="l00787"></a>00787     }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789     <span class="keywordflow">return</span>;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791 } <span class="comment">/* end HS_SetUtilParamsCmd */</span>
<a name="l00792"></a>00792 
<a name="l00793"></a><a class="code" href="hs__custom_8c.html#661cb490649afe4ef821742f807f0e82">00793</a> <span class="keywordtype">void</span> <a class="code" href="hs__custom_8c.html#661cb490649afe4ef821742f807f0e82">HS_SetUtilDiagCmd</a>(<a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/struct_c_f_e___s_b___msg__t.html">CFE_SB_MsgPtr_t</a> MessagePtr)
<a name="l00794"></a>00794 {
<a name="l00795"></a>00795     <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/common__types_8h.html#2e00abb078d312d1d8c4fbcd6be343d8">uint16</a>            ExpectedLength = <span class="keyword">sizeof</span>(<a class="code" href="struct_h_s___set_util_diag_cmd__t.html">HS_SetUtilDiagCmd_t</a>);
<a name="l00796"></a>00796     <a class="code" href="struct_h_s___set_util_diag_cmd__t.html">HS_SetUtilDiagCmd_t</a>  *CmdPtr;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="comment">/*</span>
<a name="l00799"></a>00799 <span class="comment">    ** Verify message packet length</span>
<a name="l00800"></a>00800 <span class="comment">    */</span>
<a name="l00801"></a>00801     <span class="keywordflow">if</span>(HS_VerifyMsgLength(MessagePtr, ExpectedLength))
<a name="l00802"></a>00802     {
<a name="l00803"></a>00803         HS_AppData.CmdCount++;
<a name="l00804"></a>00804         CmdPtr = ((<a class="code" href="struct_h_s___set_util_diag_cmd__t.html">HS_SetUtilDiagCmd_t</a> *)MessagePtr);
<a name="l00805"></a>00805 
<a name="l00806"></a>00806         <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a>  = CmdPtr-&gt;<a class="code" href="struct_h_s___set_util_diag_cmd__t.html#b57d6618ab9c8eccad0ad42a718f8711">Mask</a>;
<a name="l00807"></a>00807         <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#ab8630735c7be46fb4162323a112d298">CFE_EVS_SendEvent</a> (<a class="code" href="hs__custom_8c.html#2215015078a70d9b8e05545fc983059f">HS_SET_UTIL_DIAG_DBG_EID</a>, <a class="codeRef" doxygen="cfe.tag:../cfe/" href="../cfe/cfe__evs_8h.html#5551720d052dd752fcf22af0dcdc9d4e">CFE_EVS_DEBUG</a>,
<a name="l00808"></a>00808                            <span class="stringliteral">"Utilization Diagnostics Mask has been set to %08X"</span>, 
<a name="l00809"></a>00809                            <a class="code" href="hs__custom_8c.html#5ddc31ed40ce9206bdbd9d6198d97a4e">HS_CustomData</a>.<a class="code" href="struct_h_s___custom_data__t.html#1a470275a0a639c72beed6a38046d33e">UtilMask</a>);
<a name="l00810"></a>00810     }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     <span class="keywordflow">return</span>;
<a name="l00813"></a>00813 
<a name="l00814"></a>00814 } <span class="comment">/* end HS_SetUtilDiagCmd */</span>
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 <span class="comment">/************************/</span>
<a name="l00817"></a>00817 <span class="comment">/*  End of File Comment */</span>
<a name="l00818"></a>00818 <span class="comment">/************************/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Mar 3 12:58:37 2015 for CFS Health and Safety (HS) Application on  User's Guide by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
